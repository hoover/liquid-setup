#!/usr/bin/env python3

import sys
import os
from pathlib import Path
import subprocess

def log(*args):
    print(*args, file=sys.stderr)
    sys.stderr.flush()

name = sys.argv[1]
args = sys.argv[2:]
scripts_d = Path('/opt/common/hooks') / '{}.d'.format(name)
for callback in scripts_d.iterdir():
    log('+', callback.name)
    subprocess.run([str(callback)] + args, env=dict(os.environ, HOOK=name))
